// Backbone with Benefits 0.1.0 (https://github.com/javan/backbone-with-benefits)
// Copyright (c) 2014 Javan Makhmali <javan@javan.us> (http://javan.us)
// MIT license (http://opensource.org/licenses/MIT)
(function(){var a,b,c,d,e,f,g,h;"undefined"!=typeof exports&&null!==exports&&!function(){return this._=require("underscore"),exports.Backbone=this.Backbone=require("backbone")}(),Backbone.Benefits={db:{},register:function(a){this.db=a}},_.extend(Backbone.Model,{hasMany:function(a,f){var g,h,i;return i=null!=f?f:{},h=i.foreignKey,g=i.as,this.prototype[b(a)]=function(b){var f,i,j,k;switch(j=e(this.constructor),i={},!1){case!h:i[h]=this.id;break;case!g:i[""+g+"_type"]=j,i[""+g+"_id"]=this.id;break;default:h=d(j),i[h]=this.id}return f=c(a),k=f.where(i),new f.constructor(k,b)}},belongsTo:function(a,e){var f,g,h;return h=null!=e?e:{},f=h.modelName,g=h.polymorphic,this.prototype[b(a)]=function(){var b,e;switch(!1){case!g:b=this.get(""+a+"_type"),e=""+a+"_id";break;case!f:b=f,e=d(a);break;default:b=a,e=d(a)}return c(b).get(this.get(e))}}}),c=function(a){var c,d,e,g,h;for(e=[a,f(a),b(f(a))],g=0,h=e.length;h>g;g++)if(d=e[g],c=Backbone.Benefits.db[d])return c},e=function(a){var b,c,d;return null!=(b=null!=(c=a.modelName)?c:a.name)?b:null!=(d=a.toString().match(/function\s*(\w+)/))?d[1]:void 0},d=function(a){return h(g(a))+"_id"},h=function(a){return a.replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},a=function(a){return a.charAt(0).toUpperCase()+a.substring(1)},b=function(a){return a.charAt(0).toLowerCase()+a.substring(1)},f=function(a){return a.replace(/([^s])$/,"$1s")},g=function(a){return a.replace(/s$/,"")}}).call(this);
